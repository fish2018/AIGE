/* empty css                *//* empty css                 */import{K as hl,L as $,d as Je,r as c,a as me,z as ce,q as We,c as _,n as s,b as e,k as Qe,w as l,l as f,f as dl,i as il,M as rl,F as Z,B as ee,g as ae,h as j,t as h,N as ul,m as cl,O as kl,v as ml,x as p,P as Cl,Q as qe,R as Vl,S as $l,T as ll,U as He,j as Xe,V as pl,W as vl,X as _l,Y as xl,C as fl,p as g,Z as Ee,_ as Pl,$ as gl,o as r,a0 as yl,J as Ml,u as Al,e as Ul,a1 as Il,a2 as Sl,a3 as El,a4 as zl,a5 as Tl,a6 as al,a7 as tl,a8 as sl,a9 as Se,aa as je,ab as Dl,ac as Ol,ad as Ll,ae as Rl,af as Gl,ag as Fe,ah as Bl,ai as Nl,aj as jl,ak as ol,al as Fl,am as ql,an as Hl,E as Kl,G as nl,ao as Jl,ap as Wl,aq as Ql,ar as Xl}from"./index-B-Gmv-2K.js";import{_ as Ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{k as Yl}from"./marked.esm-z4go5P_g.js";const Ze=hl("admin",()=>({getUsers:async()=>(await $.get("/admin/users")).users,getUser:async n=>await $.get(`/admin/users/${n}`),updateUserPassword:async(n,m)=>{await $.put(`/admin/users/${n}/password`,{new_password:m})},deleteUser:async n=>{await $.delete(`/admin/users/${n}`)},toggleUserAdmin:async n=>{await $.put(`/admin/users/${n}/toggle-admin`)},getProviders:async()=>(await $.get("/admin/providers")).providers,getProvider:async n=>await $.get(`/admin/providers/${n}`),createProvider:async n=>await $.post("/admin/providers",n),updateProvider:async(n,m)=>await $.put(`/admin/providers/${n}`,m),deleteProvider:async n=>{await $.delete(`/admin/providers/${n}`)},toggleProvider:async n=>await $.put(`/admin/providers/${n}/toggle`),getAvailableModels:async(n,m)=>{const D=m?`/admin/providers/${n}/models/available?api_type=${m}`:`/admin/providers/${n}/models/available`;return(await $.get(D)).models},testConnection:async(n,m)=>{const D=m?`/admin/providers/${n}/test?model_id=${m}`:`/admin/providers/${n}/test`;return await $.get(D)},getModels:async n=>{const m=n?`/admin/models?provider_id=${n}`:"/admin/models";return(await $.get(m)).models},getModel:async n=>await $.get(`/admin/models/${n}`),createModel:async n=>await $.post("/admin/models",n),updateModel:async(n,m)=>await $.put(`/admin/models/${n}`,m),deleteModel:async n=>{await $.delete(`/admin/models/${n}`)},toggleModel:async n=>await $.put(`/admin/models/${n}/toggle`),testModel:async n=>await $.post(`/admin/models/${n}/test`),updateModelCapabilities:async(n,m)=>await $.put(`/admin/models/${n}/capabilities`,{capabilities:m}),getOAuthConfig:async()=>await $.get("/admin/oauth/config"),saveOAuthConfig:async n=>{await $.post("/admin/oauth/config",n)}})),Zl={class:"provider-management"},ea={class:"game-ai-config",style:{"margin-bottom":"24px"}},la={class:"config-header"},aa={class:"config-content"},ta={class:"default-model-selectors"},sa={class:"game-model-list"},oa={class:"game-info"},na={class:"game-name"},da={class:"model-selectors"},ia={key:0,class:"no-games"},ra={style:{"margin-bottom":"24px"}},ua={class:"page-header"},ca={key:0,class:"empty-state"},ma={key:1,class:"providers-list"},pa={class:"provider-header"},va={class:"provider-title"},_a={style:{margin:"0 8px","font-size":"16px","font-weight":"500"}},fa={class:"provider-actions"},ga={class:"provider-fields"},ya={class:"field-item"},ba={class:"field-item"},wa={class:"field-label"},ha={key:0,style:{"font-size":"12px",color:"#909399"}},ka={class:"models-header"},Ca={class:"field-label"},Va={class:"models-list"},$a={key:0,class:"models-empty"},xa={class:"model-info"},Pa={class:"model-name"},Ma={class:"model-actions"},Aa={class:"provider-types"},Ua=["onClick"],Ia={key:0,style:{"margin-left":"12px",color:"#67c23a"}},Sa={class:"model-select-list"},Ea=["onClick"],za={key:0,class:"model-select-empty"},Ta=Je({__name:"ProviderManagement",setup(he){const x=Ze(),O=c([]),J=c(!1),P=c(!1),C=c(!1),z=c(!1),U=c(!1),M=c(null),I=c(null),k=c(null),B=c(!1),S=c([]),F=c(""),q=c(""),te=c(null),L=c([]),y=me({defaultModelId:"",gameModels:{}}),W=c(!1),R=c(null),le=c(""),se=me({}),w=me({}),n=ce(()=>O.value.filter(t=>t.enabled)),m=ce(()=>{const t=[];for(const a of O.value)if(a.models)for(const u of a.models)u.enabled&&a.enabled&&t.push({...u,provider:a});return t}),D=ce(()=>R.value?m.value.filter(t=>t.provider_id===R.value):[]),ne=t=>{const a=se[t];return a?m.value.filter(u=>u.provider_id===a):[]},V=c({type:"openai",name:"",api_key:"",base_url:""}),T=c({model_id:"",name:"",api_type:"openai",provider_id:0}),A=[{value:"openai",label:"OpenAI",description:"GPT-4, GPT-3.5等模型"},{value:"anthropic",label:"Anthropic",description:"Claude系列模型"},{value:"google",label:"Google",description:"Gemini系列模型"},{value:"custom",label:"自定义",description:"兼容OpenAI格式的API"}],pe=ce(()=>{if(!F.value.trim())return S.value;const t=F.value.toLowerCase().trim().split(/\s+/);return S.value.filter(a=>{const u=a.toLowerCase();return t.every(i=>u.includes(i))})}),ve=t=>({openai:"OpenAI",anthropic:"Anthropic",google:"Google",custom:"自定义"})[t]||t,ke=t=>({openai:"success",anthropic:"",google:"warning",custom:"info"})[t]||"info",ye=t=>({openai:"https://api.openai.com/v1/chat/completions",anthropic:"https://api.anthropic.com/v1/messages",google:"https://generativelanguage.googleapis.com/v1beta",custom:"https://api.example.com/v1"})[t]||"",Ce=t=>({openai:"OpenAI",anthropic:"Claude",google:"Gemini"})[t]||t,ze=t=>({openai:"success",anthropic:"",google:"warning"})[t]||"info",v=async()=>{J.value=!0;try{O.value=await x.getProviders()}catch(t){g.error(t.message||"加载提供商失败")}finally{J.value=!1}},o=t=>{P.value=!1,V.value={type:t,name:ve(t),api_key:"",base_url:""},C.value=!0},b=t=>{M.value=t,V.value={type:t.type,name:t.name,api_key:t.api_key,base_url:t.base_url||""},C.value=!0},X=async t=>{try{await x.toggleProvider(t.id)}catch(a){t.enabled=!t.enabled,g.error(a.message||"操作失败")}},be=async(t,a,u)=>{const i={api_key:a==="api_key"?u:t.api_key,base_url:a==="base_url"?u:t.base_url};try{await x.updateProvider(t.id,i),a==="api_key"?t.api_key=u:t.base_url=u}catch(N){g.error(N.message||"更新失败")}},Te=async t=>{try{await Ee.confirm(`确定要删除提供商 "${t.name}" 吗？这将同时删除其所有模型配置。`,"确认删除",{type:"warning"}),await x.deleteProvider(t.id),g.success("删除成功"),await v()}catch(a){a!=="cancel"&&g.error(a.message||"删除失败")}},Q=async()=>{if(!V.value.name||!V.value.api_key){g.warning("请填写必填项");return}U.value=!0;try{M.value?(await x.updateProvider(M.value.id,V.value),g.success("更新成功")):(await x.createProvider(V.value),g.success("添加成功")),C.value=!1,M.value=null,await v()}catch(t){g.error(t.message||"保存失败")}finally{U.value=!1}},Ve=t=>{k.value=t,I.value=null,T.value={model_id:"",name:"",api_type:t.type==="custom"?"openai":t.type,provider_id:t.id},S.value=[],F.value="",q.value="",z.value=!0},De=(t,a)=>{k.value=t,I.value=a,T.value={model_id:a.model_id,name:a.name,api_type:a.api_type||t.type,provider_id:t.id},S.value=[],F.value="",q.value="",z.value=!0},_e=async t=>{try{await x.toggleModel(t.id)}catch(a){t.enabled=!t.enabled,g.error(a.message||"操作失败")}},$e=async(t,a)=>{try{await Ee.confirm(`确定要删除模型 "${a.name}" 吗？`,"确认删除",{type:"warning"}),await x.deleteModel(a.id),g.success("删除成功"),await v()}catch(u){u!=="cancel"&&g.error(u.message||"删除失败")}},xe=async(t,a)=>{te.value=a.id;try{const{AIService:u}=await Pl(async()=>{const{AIService:N}=await Promise.resolve().then(()=>Oa);return{AIService:N}},void 0),i=await u.testConnection({provider_id:t.id,model_id:a.model_id,api_type:a.api_type||t.type});i.success?g.success(`模型 "${a.name}" 连接测试成功`):g.error(`测试失败: ${i.message}`)}catch(u){g.error(`测试失败: ${u.message}`)}finally{te.value=null}},Oe=()=>{S.value=[],q.value=""},de=async()=>{if(k.value){B.value=!0,q.value="";try{const t=await x.getAvailableModels(k.value.id,T.value.api_type);S.value=t,t.length===0?q.value="未找到可用模型":g.success(`获取到 ${t.length} 个模型`)}catch(t){q.value=t.message||"获取模型列表失败，请检查API密钥和URL配置"}finally{B.value=!1}}},fe=t=>{T.value.model_id=t,T.value.name=t},Le=async()=>{if(!T.value.model_id||!T.value.name){g.warning("请填写模型ID和名称");return}U.value=!0;try{I.value?(await x.updateModel(I.value.id,T.value),g.success("更新成功")):(await x.createModel(T.value),g.success("添加成功")),re(),await v()}catch(t){g.error(t.message||"保存失败")}finally{U.value=!1}},re=()=>{z.value=!1,I.value=null,k.value=null,S.value=[],F.value="",q.value=""},Pe=async()=>{try{const t=await fetch("/api/game/mods",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(t.ok){L.value=await t.json();for(const a of L.value)a.game_id in y.gameModels||(y.gameModels[a.game_id]="")}}catch(t){console.error("加载游戏列表失败:",t)}},Re=async()=>{try{const t=await fetch("/api/admin/game/model-config",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(t.ok){const a=await t.json();y.defaultModelId=String(a.default_model_id||"");const u={};if(a.game_models)for(const[i,N]of Object.entries(a.game_models))u[i]=String(N||"");y.gameModels=u,console.log("游戏配置加载完成"),Ie()}}catch(t){console.error("加载游戏配置失败:",t)}},Me=async()=>{W.value=!0;try{const t=await fetch("/api/admin/game/model-config",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({default_model_id:y.defaultModelId,game_models:y.gameModels})});if(t.ok)g.success("游戏AI配置已保存");else{const a=await t.json();g.error(a.error||"保存失败")}}catch(t){g.error(t.message||"保存失败")}finally{W.value=!1}},H=()=>{le.value="",ge()},Ae=()=>{ge()},Y=t=>{w[t]="",Ue(t)},Ge=t=>{Ue(t)},ge=()=>{if(le.value){const t=D.value.find(a=>a.model_id===le.value);y.defaultModelId=t?String(t.id):""}else y.defaultModelId=""},Ue=t=>{if(w[t]){const u=ne(t).find(i=>i.model_id===w[t]);y.gameModels[t]=u?String(u.id):""}else y.gameModels[t]=""},Ie=()=>{if(y.defaultModelId){const t=m.value.find(a=>String(a.id)===y.defaultModelId);t&&(R.value=t.provider_id,le.value=t.model_id)}for(const[t,a]of Object.entries(y.gameModels))if(a){const u=m.value.find(i=>String(i.id)===a);u&&(se[t]=u.provider_id,w[t]=u.model_id)}};return We(async()=>{await v(),await Re(),await Pe()}),(t,a)=>{const u=Qe,i=vl,N=rl,G=il,oe=ul,Be=dl,bl=cl,ie=ml,el=Vl,ue=Xe,Ne=pl,wl=gl;return r(),_("div",Zl,[s("div",ea,[s("div",la,[a[15]||(a[15]=s("h3",null,"🎮 游戏AI配置",-1)),e(u,{type:"success",size:"small",onClick:Me,loading:W.value},{default:l(()=>[...a[14]||(a[14]=[f(" 保存配置 ",-1)])]),_:1},8,["loading"])]),s("div",aa,[e(Be,{"label-width":"120px"},{default:l(()=>[e(G,{label:"默认模型"},{default:l(()=>[s("div",ta,[e(N,{modelValue:R.value,"onUpdate:modelValue":a[0]||(a[0]=d=>R.value=d),placeholder:"选择提供商",onChange:H,size:"small",style:{width:"150px"}},{default:l(()=>[(r(!0),_(Z,null,ee(n.value,d=>(r(),ae(i,{key:d.id,label:d.name,value:d.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(N,{modelValue:le.value,"onUpdate:modelValue":a[1]||(a[1]=d=>le.value=d),placeholder:"选择模型",disabled:!R.value,onChange:Ae,size:"small",style:{width:"200px"}},{default:l(()=>[(r(!0),_(Z,null,ee(D.value,d=>(r(),ae(i,{key:d.id,label:d.name,value:d.model_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])])]),_:1}),e(G,{label:"游戏专用模型"},{default:l(()=>[s("div",sa,[(r(!0),_(Z,null,ee(L.value,d=>(r(),_("div",{key:d.game_id,class:"game-model-item"},[s("div",oa,[s("span",na,h(d.name),1),e(oe,{size:"small",type:"info"},{default:l(()=>[f(h(d.game_id),1)]),_:2},1024)]),s("div",da,[e(N,{modelValue:se[d.game_id],"onUpdate:modelValue":K=>se[d.game_id]=K,placeholder:"选择提供商",onChange:()=>Y(d.game_id),size:"small",style:{width:"150px"}},{default:l(()=>[(r(!0),_(Z,null,ee(n.value,K=>(r(),ae(i,{key:K.id,label:K.name,value:K.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","onChange"]),e(N,{modelValue:w[d.game_id],"onUpdate:modelValue":K=>w[d.game_id]=K,placeholder:"选择模型",disabled:!se[d.game_id],onChange:()=>Ge(d.game_id),size:"small",style:{width:"200px"}},{default:l(()=>[(r(!0),_(Z,null,ee(ne(d.game_id),K=>(r(),ae(i,{key:K.id,label:K.name,value:K.model_id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])])]))),128)),!L.value||L.value.length===0?(r(),_("div",ia," 暂无可用游戏 ")):j("",!0)])]),_:1})]),_:1})])]),e(bl),s("div",ra,[s("div",ua,[a[17]||(a[17]=s("h3",null,"AI服务提供商",-1)),e(u,{type:"primary",onClick:a[2]||(a[2]=d=>P.value=!0)},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(Cl))]),_:1}),a[16]||(a[16]=s("span",null,"添加提供商",-1))]),_:1})]),a[24]||(a[24]=kl('<div class="info-box" data-v-a6d4de80><h4 class="info-title" data-v-a6d4de80>API配置说明</h4><div class="info-content" data-v-a6d4de80><div data-v-a6d4de80><strong data-v-a6d4de80>OpenAI及兼容服务：</strong>API URL填写完整路径，如 <code class="bg-blue-100 px-1 rounded" data-v-a6d4de80>https://api.openai.com/v1/chat/completions</code></div><div data-v-a6d4de80><strong data-v-a6d4de80>Anthropic Claude：</strong>API URL填写 <code class="bg-blue-100 px-1 rounded" data-v-a6d4de80>https://api.anthropic.com/v1/messages</code></div><div data-v-a6d4de80><strong data-v-a6d4de80>Google Gemini：</strong>API URL填写 <code class="bg-blue-100 px-1 rounded" data-v-a6d4de80>https://generativelanguage.googleapis.com/v1beta</code></div><div data-v-a6d4de80><strong data-v-a6d4de80>自定义提供商：</strong>大多数第三方服务使用OpenAI兼容格式</div></div></div>',1)),O.value.length===0?(r(),_("div",ca,[e(ie,{style:{"font-size":"60px",color:"#dcdfe6","margin-bottom":"16px"}},{default:l(()=>[e(p(qe))]),_:1}),a[18]||(a[18]=s("p",null,"还没有配置任何AI提供商",-1)),a[19]||(a[19]=s("p",{style:{"font-size":"14px","margin-top":"8px",color:"#909399"}},"点击上方按钮添加您的第一个AI服务",-1))])):(r(),_("div",ma,[(r(!0),_(Z,null,ee(O.value,d=>{var K;return r(),_("div",{key:d.id,class:"provider-card"},[s("div",pa,[s("div",va,[e(el,{modelValue:d.enabled,"onUpdate:modelValue":E=>d.enabled=E,onChange:E=>X(d)},null,8,["modelValue","onUpdate:modelValue","onChange"]),s("h4",_a,h(d.name),1),e(oe,{size:"small",type:ke(d.type)},{default:l(()=>[f(h(ve(d.type)),1)]),_:2},1032,["type"]),d.enabled&&d.api_key?(r(),ae(ie,{key:0,style:{color:"#67c23a"},title:"已配置"},{default:l(()=>[e(p($l))]),_:1})):j("",!0)]),s("div",fa,[e(u,{size:"small",onClick:E=>b(d),title:"编辑提供商"},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(ll))]),_:1})]),_:1},8,["onClick"]),e(u,{size:"small",type:"danger",onClick:E=>Te(d),title:"删除提供商"},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(He))]),_:1})]),_:1},8,["onClick"])])]),s("div",ga,[s("div",ya,[a[20]||(a[20]=s("label",{class:"field-label"},"API密钥",-1)),e(ue,{"model-value":d.api_key,type:"password","show-password":"",placeholder:"输入API密钥","onUpdate:modelValue":E=>be(d,"api_key",E)},null,8,["model-value","onUpdate:modelValue"])]),s("div",ba,[s("label",wa,[a[21]||(a[21]=f(" API URL ",-1)),d.type!=="custom"?(r(),_("span",ha,"(可选)")):j("",!0)]),e(ue,{"model-value":d.base_url,type:"url",placeholder:ye(d.type),"onUpdate:modelValue":E=>be(d,"base_url",E)},null,8,["model-value","placeholder","onUpdate:modelValue"])])]),s("div",null,[s("div",ka,[s("label",Ca,"可用模型 ("+h(((K=d.models)==null?void 0:K.length)||0)+")",1),e(u,{size:"small",type:"primary",link:"",onClick:E=>Ve(d)},{default:l(()=>[...a[22]||(a[22]=[f(" 添加模型 ",-1)])]),_:1},8,["onClick"])]),s("div",Va,[!d.models||d.models.length===0?(r(),_("div",$a," 暂无模型 ")):j("",!0),(r(!0),_(Z,null,ee(d.models,E=>(r(),_("div",{key:E.id,class:"model-item"},[s("div",xa,[e(el,{modelValue:E.enabled,"onUpdate:modelValue":we=>E.enabled=we,onChange:we=>_e(E)},null,8,["modelValue","onUpdate:modelValue","onChange"]),s("span",Pa,h(E.name),1),E.api_type?(r(),ae(oe,{key:0,size:"small",type:ze(E.api_type)},{default:l(()=>[f(h(Ce(E.api_type)),1)]),_:2},1032,["type"])):j("",!0)]),s("div",Ma,[e(u,{size:"small",onClick:we=>xe(d,E),loading:E.id===te.value},{default:l(()=>[...a[23]||(a[23]=[f(" 测试 ",-1)])]),_:1},8,["onClick","loading"]),e(u,{size:"small",onClick:we=>De(d,E)},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(ll))]),_:1})]),_:1},8,["onClick"]),e(u,{size:"small",type:"danger",onClick:we=>$e(d,E)},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(He))]),_:1})]),_:1},8,["onClick"])])]))),128))])])])}),128))]))]),e(Ne,{modelValue:P.value,"onUpdate:modelValue":a[3]||(a[3]=d=>P.value=d),title:"选择提供商类型",width:"500px"},{default:l(()=>[s("div",Aa,[(r(),_(Z,null,ee(A,d=>s("div",{key:d.value,class:"provider-type-card",onClick:K=>o(d.value)},[s("h4",null,h(d.label),1),s("p",null,h(d.description),1)],8,Ua)),64))])]),_:1},8,["modelValue"]),e(Ne,{modelValue:C.value,"onUpdate:modelValue":a[8]||(a[8]=d=>C.value=d),title:M.value?"编辑提供商":"添加提供商",width:"500px"},{footer:l(()=>[e(u,{onClick:a[7]||(a[7]=d=>C.value=!1)},{default:l(()=>[...a[26]||(a[26]=[f("取消",-1)])]),_:1}),e(u,{type:"primary",loading:U.value,onClick:Q},{default:l(()=>[f(h(M.value?"更新":"添加"),1)]),_:1},8,["loading"])]),default:l(()=>[e(Be,{model:V.value,"label-width":"100px"},{default:l(()=>[e(G,{label:"类型"},{default:l(()=>[e(oe,null,{default:l(()=>[f(h(ve(V.value.type)),1)]),_:1})]),_:1}),e(G,{label:"名称",required:""},{default:l(()=>[e(ue,{modelValue:V.value.name,"onUpdate:modelValue":a[4]||(a[4]=d=>V.value.name=d),placeholder:"输入提供商名称"},null,8,["modelValue"])]),_:1}),e(G,{label:"API密钥",required:""},{default:l(()=>[e(ue,{modelValue:V.value.api_key,"onUpdate:modelValue":a[5]||(a[5]=d=>V.value.api_key=d),type:"password","show-password":"",placeholder:"输入API密钥"},null,8,["modelValue"])]),_:1}),e(G,{label:"API URL"},{default:l(()=>[e(ue,{modelValue:V.value.base_url,"onUpdate:modelValue":a[6]||(a[6]=d=>V.value.base_url=d),type:"url",placeholder:ye(V.value.type)},null,8,["modelValue","placeholder"]),a[25]||(a[25]=s("div",{style:{"font-size":"12px",color:"#909399","margin-top":"4px"}},"留空使用默认地址",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(Ne,{modelValue:z.value,"onUpdate:modelValue":a[13]||(a[13]=d=>z.value=d),title:I.value?"编辑模型":"添加模型",width:"600px"},{footer:l(()=>[e(u,{onClick:re},{default:l(()=>[...a[28]||(a[28]=[f("取消",-1)])]),_:1}),e(u,{type:"primary",loading:U.value,onClick:Le},{default:l(()=>[f(h(I.value?"更新":"添加"),1)]),_:1},8,["loading"])]),default:l(()=>[e(Be,{model:T.value,"label-width":"100px"},{default:l(()=>[e(G,{label:"API类型"},{default:l(()=>[e(N,{modelValue:T.value.api_type,"onUpdate:modelValue":a[9]||(a[9]=d=>T.value.api_type=d),placeholder:"选择API类型",onChange:Oe},{default:l(()=>[e(i,{label:"OpenAI",value:"openai"}),e(i,{label:"Anthropic",value:"anthropic"}),e(i,{label:"Google",value:"google"})]),_:1},8,["modelValue"])]),_:1}),e(G,{label:"模型ID",required:""},{default:l(()=>[e(ue,{modelValue:T.value.model_id,"onUpdate:modelValue":a[10]||(a[10]=d=>T.value.model_id=d),placeholder:"如：gpt-4o"},null,8,["modelValue"])]),_:1}),e(G,{label:"显示名称",required:""},{default:l(()=>[e(ue,{modelValue:T.value.name,"onUpdate:modelValue":a[11]||(a[11]=d=>T.value.name=d),placeholder:"如：GPT-4o"},null,8,["modelValue"])]),_:1}),e(G,{label:""},{default:l(()=>[e(u,{onClick:de,loading:B.value,type:"primary"},{default:l(()=>[e(ie,null,{default:l(()=>[e(p(_l))]),_:1}),a[27]||(a[27]=f(" 获取模型列表 ",-1))]),_:1},8,["loading"]),S.value.length>0?(r(),_("span",Ia," 已获取 "+h(S.value.length)+" 个模型 ",1)):j("",!0)]),_:1}),S.value.length>0?(r(),ae(G,{key:0,label:"搜索过滤"},{default:l(()=>[e(ue,{modelValue:F.value,"onUpdate:modelValue":a[12]||(a[12]=d=>F.value=d),placeholder:"搜索模型（支持多关键词）",clearable:""},{prefix:l(()=>[e(ie,null,{default:l(()=>[e(p(xl))]),_:1})]),_:1},8,["modelValue"])]),_:1})):j("",!0),S.value.length>0?(r(),ae(G,{key:1,label:"可用模型"},{default:l(()=>[s("div",Sa,[(r(!0),_(Z,null,ee(pe.value,d=>(r(),_("div",{key:d,class:fl(["model-select-item",{selected:T.value.model_id===d}]),onClick:K=>fe(d)},h(d),11,Ea))),128)),pe.value.length===0?(r(),_("div",za," 没有匹配的模型 ")):j("",!0)])]),_:1})):j("",!0),q.value?(r(),ae(wl,{key:2,type:"error",title:q.value,closable:!1,style:{"margin-bottom":"16px"}},null,8,["title"])):j("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Da=Ye(Ta,[["__scopeId","data-v-a6d4de80"]]);class Ke{static async chat(x){return await $.post("/admin/ai/chat",x)}static async chatStream(x,O,J,P){var C;try{const z=localStorage.getItem("token"),M=await fetch("http://localhost:8182/api/admin/ai/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${z}`},body:JSON.stringify({...x,stream:!0})});if(!M.ok){const F=await M.text();throw new Error(`HTTP ${M.status}: ${F}`)}const I=(C=M.body)==null?void 0:C.getReader();if(!I)throw new Error("无法获取响应流");const k=new TextDecoder;let B="",S=0;for(;;){const{done:F,value:q}=await I.read();if(F){P();break}const te=k.decode(q,{stream:!0});B+=te;const L=B.split(`
`);B=L.pop()||"";for(const y of L)if(y.trim()&&!y.startsWith("event:")&&y.startsWith("data:")){const W=y.slice(5).trim();if(!W)continue;try{const R=JSON.parse(W);if(R.content!==void 0&&R.content!==""&&(S++,O(R.content)),R.done){P();return}}catch(R){console.error("[AIService] 解析SSE数据失败:",R,W)}}}}catch(z){console.error("[AIService] chatStream错误:",z),J(z)}}static async testConnection(x){return await $.post("/admin/ai/test",x)}}const Oa=Object.freeze(Object.defineProperty({__proto__:null,AIService:Ke},Symbol.toStringTag,{value:"Module"})),La={class:"playground"},Ra={class:"playground-container"},Ga={class:"chat-panel"},Ba={class:"config-bar"},Na={style:{display:"flex","align-items":"center",gap:"8px"}},ja={class:"message-role"},Fa=["innerHTML"],qa={key:0,class:"message message-assistant"},Ha={class:"input-container"},Ka={class:"input-actions"},Ja=Je({__name:"Playground",setup(he){const x=Ze(),O=c([]),J=c([]),P=c(null),C=c(""),z=c(!0),U=c([]),M=c(""),I=c(!1),k=c(!1),B=c(),S=ce(()=>O.value.filter(w=>w.enabled)),F=ce(()=>P.value?J.value.filter(w=>w.provider_id===P.value&&w.enabled):[]),q=w=>{try{const n=Yl(w,{breaks:!0,gfm:!0});return typeof n=="string"?n:String(n)}catch{return w.replace(/\n/g,"<br>")}},te=()=>{C.value="",y()},L=async()=>{try{O.value=await x.getProviders()}catch(w){g.error("加载提供商失败: "+w.message)}},y=async()=>{if(P.value)try{J.value=await x.getModels(P.value)}catch(w){g.error("加载模型失败: "+w.message)}},W=()=>{Ml(()=>{B.value&&(B.value.scrollTop=B.value.scrollHeight)})},R=w=>{w.ctrlKey&&w.key==="Enter"&&(w.preventDefault(),le())},le=async()=>{if(!M.value.trim()||!C.value||!P.value)return;const w={role:"user",content:M.value.trim()};U.value.push(w),M.value="",W();try{if(z.value){k.value=!0,W();let n="",m=-1;await Ke.chatStream({provider_id:P.value,model_id:C.value,messages:U.value,stream:!0},D=>{m===-1&&(k.value=!1,U.value.push({role:"assistant",content:""}),m=U.value.length-1),n+=D,U.value[m].content=n,W()},D=>{console.error("[Playground] onError 被调用:",D),k.value=!1,I.value=!1,g.error("对话失败: "+D.message)},()=>{k.value=!1,I.value=!1,W()})}else{I.value=!0;const n=await Ke.chat({provider_id:P.value,model_id:C.value,messages:U.value,stream:!1});U.value.push({role:"assistant",content:n.content}),I.value=!1,W()}}catch(n){I.value=!1,k.value=!1,g.error("发送消息失败: "+n.message)}},se=()=>{U.value=[]};return We(()=>{L()}),(w,n)=>{const m=vl,D=rl,ne=yl,V=Qe,T=Xe;return r(),_("div",La,[n[10]||(n[10]=s("div",{class:"playground-header"},[s("h2",null,"AI 操练场"),s("p",{class:"header-desc"},"选择提供商和模型进行对话测试")],-1)),s("div",Ra,[s("div",Ga,[s("div",Ba,[e(D,{modelValue:P.value,"onUpdate:modelValue":n[0]||(n[0]=A=>P.value=A),placeholder:"选择提供商",onChange:te,style:{width:"200px"},size:"small"},{default:l(()=>[(r(!0),_(Z,null,ee(S.value,A=>(r(),ae(m,{key:A.id,label:A.name,value:A.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(D,{modelValue:C.value,"onUpdate:modelValue":n[1]||(n[1]=A=>C.value=A),placeholder:"选择模型",disabled:!P.value,style:{width:"250px"},size:"small"},{default:l(()=>[(r(!0),_(Z,null,ee(F.value,A=>(r(),ae(m,{key:A.id,label:A.name,value:A.model_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),s("div",Na,[n[4]||(n[4]=s("span",{style:{"font-size":"14px",color:"#666"}},"流式输出",-1)),e(ne,{modelValue:z.value,"onUpdate:modelValue":n[2]||(n[2]=A=>z.value=A),size:"small"},null,8,["modelValue"])]),n[6]||(n[6]=s("div",{style:{flex:"1"}},null,-1)),e(V,{size:"small",onClick:se,disabled:U.value.length===0},{default:l(()=>[...n[5]||(n[5]=[f(" 清空对话 ",-1)])]),_:1},8,["disabled"])]),s("div",{class:"messages-container",ref_key:"messagesContainer",ref:B},[(r(!0),_(Z,null,ee(U.value,(A,pe)=>(r(),_("div",{key:pe,class:fl(["message",`message-${A.role}`])},[s("div",ja,h(A.role==="user"?"用户":"AI"),1),s("div",{class:"message-content",innerHTML:q(A.content)},null,8,Fa)],2))),128)),k.value?(r(),_("div",qa,[...n[7]||(n[7]=[s("div",{class:"message-role"},"AI",-1),s("div",{class:"message-content typing-indicator"},[s("span"),s("span"),s("span")],-1)])])):j("",!0)],512),s("div",Ha,[e(T,{modelValue:M.value,"onUpdate:modelValue":n[3]||(n[3]=A=>M.value=A),type:"textarea",rows:3,placeholder:"输入消息... (Ctrl+Enter 发送)",onKeydown:R,disabled:I.value||!C.value},null,8,["modelValue","disabled"]),s("div",Ka,[n[9]||(n[9]=s("span",{class:"input-hint"},"Ctrl + Enter 发送",-1)),e(V,{type:"primary",onClick:le,loading:I.value,disabled:!M.value.trim()||!C.value},{default:l(()=>[...n[8]||(n[8]=[f(" 发送 ",-1)])]),_:1},8,["loading","disabled"])])])])])])}}}),Wa=Ye(Ja,[["__scopeId","data-v-362b6de1"]]),Qa={class:"admin-container"},Xa={class:"header-content"},Ya={class:"mobile-menu-btn"},Za={class:"breadcrumb"},et={class:"mobile-title"},lt={class:"user-info"},at={class:"el-dropdown-link"},tt={key:0,class:"overview-content"},st={class:"stats-item"},ot={class:"stats-number"},nt={class:"stats-item"},dt={class:"stats-number"},it={class:"stats-item"},rt={class:"stats-number"},ut={key:1},ct={class:"card-header"},mt={class:"table-container pc-table"},pt={class:"action-buttons"},vt={class:"mobile-user-list"},_t={class:"user-info"},ft={class:"user-header"},gt={class:"username"},yt={class:"user-detail"},bt={class:"detail-item"},wt={class:"detail-value"},ht={class:"detail-item"},kt={class:"detail-value"},Ct={class:"user-actions"},Vt={key:2},$t={key:3},xt={key:4},Pt={class:"card-header"},Mt={style:{"margin-left":"10px",color:"#909399"}},At={key:5},Ut={class:"mobile-sidebar"},It={class:"dialog-footer"},St=Je({__name:"AdminView",setup(he){const x=Ul(),O=Al(),J=Ze(),P=c(!1),C=c([]),z=c(!1),U=c(!1),M=c(null),I=c(),k=c("overview"),B=c(!1),S=c(!1),F=ce(()=>C.value.length),q=ce(()=>C.value.filter(v=>v.is_admin).length),te=c(0),L=me({siteName:"AI Game Engine",siteDescription:"一个基于AI的文字冒险游戏引擎",allowRegister:!0}),y=me({newPassword:"",confirmPassword:""}),R=me({newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(v,o,b)=>{o!==y.newPassword?b(new Error("两次输入密码不一致")):b()},trigger:"blur"}]});We(()=>{if(!O.isAdmin()){x.push("/chat");return}V(),m()});const le=v=>{k.value=v,v==="users"?V():v==="oauth"&&m()},se=()=>{S.value=!S.value},w=v=>{k.value=v,S.value=!1,v==="users"?V():v==="oauth"&&m()},n=me({client_id:"",client_secret:"",redirect_url:`${window.location.origin}/auth/callback/linux-do`,auth_url:"https://connect.linux.do/oauth2/authorize",token_url:"https://connect.linux.do/oauth2/token",user_info_url:"https://connect.linux.do/api/user",enabled:!1}),m=async()=>{try{const v=await J.getOAuthConfig();Object.assign(n,v)}catch(v){console.error("加载 OAuth 配置失败:",v)}},D=async()=>{try{B.value=!0,await J.saveOAuthConfig(n),g.success("OAuth 配置保存成功")}catch(v){console.error("保存 OAuth 配置失败:",v)}finally{B.value=!1}},ne=()=>({overview:"概览",users:"用户管理",providers:"提供商管理",playground:"操练场",oauth:"OAuth配置",system:"系统设置"})[k.value]||"概览",V=async()=>{P.value=!0;try{C.value=await J.getUsers()}catch(v){console.error("获取用户列表失败:",v)}finally{P.value=!1}},T=()=>{V()},A=v=>{M.value=v,y.newPassword="",y.confirmPassword="",z.value=!0},pe=async()=>{if(!(!I.value||!M.value))try{if(!await I.value.validate())return;U.value=!0,await J.updateUserPassword(M.value.id,y.newPassword),g.success("密码修改成功"),z.value=!1}catch(v){console.error("密码修改失败:",v)}finally{U.value=!1}},ve=async v=>{try{await Ee.confirm(`确定要${v.is_admin?"取消":"设置"}用户 "${v.username}" 的管理员权限吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await J.toggleUserAdmin(v.id),g.success("权限修改成功"),await V()}catch(o){o!=="cancel"&&console.error("权限修改失败:",o)}},ke=async v=>{try{await Ee.confirm(`确定要删除用户 "${v.username}" 吗？此操作不可恢复！`,"确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}),await J.deleteUser(v.id),g.success("用户删除成功"),await V()}catch(o){o!=="cancel"&&console.error("用户删除失败:",o)}},ye=()=>{O.logout()},Ce=()=>{x.push("/chat")},ze=()=>{g.success("系统设置已保存")};return(v,o)=>{const b=ml,X=Tl,be=zl,Te=El,Q=Qe,Ve=Rl,De=Ll,_e=jl,$e=Nl,xe=Gl,Oe=Dl,de=Kl,fe=Hl,Le=ql,re=Wl,Pe=ul,Re=Xl,Me=yl,H=il,Ae=cl,Y=Xe,Ge=gl,ge=dl,Ue=Fl,Ie=Il,t=Sl,a=pl,u=Jl;return r(),_("div",Qa,[e(Ie,{style:{height:"100vh"}},{default:l(()=>[e(Te,{width:"250px",class:"admin-sidebar pc-sidebar"},{default:l(()=>[e(be,{"default-active":k.value,class:"admin-menu","background-color":"#001529","text-color":"#ffffff","active-text-color":"#1890ff",onSelect:le},{default:l(()=>[e(X,{index:"overview"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(al))]),_:1}),o[15]||(o[15]=s("span",null,"概览",-1))]),_:1}),e(X,{index:"users"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(tl))]),_:1}),o[16]||(o[16]=s("span",null,"用户管理",-1))]),_:1}),e(X,{index:"providers"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(sl))]),_:1}),o[17]||(o[17]=s("span",null,"提供商管理",-1))]),_:1}),e(X,{index:"playground"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Se))]),_:1}),o[18]||(o[18]=s("span",null,"操练场",-1))]),_:1}),e(X,{index:"oauth"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(je))]),_:1}),o[19]||(o[19]=s("span",null,"OAuth配置",-1))]),_:1}),e(X,{index:"system"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(qe))]),_:1}),o[20]||(o[20]=s("span",null,"系统设置",-1))]),_:1})]),_:1},8,["default-active"])]),_:1}),e(Ie,null,{default:l(()=>[e(Oe,{class:"admin-header"},{default:l(()=>[s("div",Xa,[s("div",Ya,[e(Q,{type:"text",onClick:se,class:"menu-toggle",size:"large"},{default:l(()=>[e(b,{size:"20"},{default:l(()=>[e(p(Ol))]),_:1})]),_:1})]),s("div",Za,[e(De,{separator:"/",class:"pc-breadcrumb"},{default:l(()=>[e(Ve,null,{default:l(()=>[...o[21]||(o[21]=[f("管理后台",-1)])]),_:1}),e(Ve,null,{default:l(()=>[f(h(ne()),1)]),_:1})]),_:1}),s("h3",et,h(ne()),1)]),s("div",lt,[e(xe,{class:"pc-user-dropdown"},{dropdown:l(()=>[e($e,null,{default:l(()=>[e(_e,{onClick:Ce},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Se))]),_:1}),o[22]||(o[22]=f(" 返回主页 ",-1))]),_:1}),e(_e,{divided:"",onClick:ye},{default:l(()=>[e(b,null,{default:l(()=>[e(p(ol))]),_:1}),o[23]||(o[23]=f(" 退出登录 ",-1))]),_:1})]),_:1})]),default:l(()=>{var i;return[s("span",at,[e(b,null,{default:l(()=>[e(p(Fe))]),_:1}),f(" "+h((i=p(O).user)==null?void 0:i.username)+" ",1),e(b,{class:"el-icon--right"},{default:l(()=>[e(p(Bl))]),_:1})])]}),_:1}),e(xe,{class:"mobile-user-dropdown"},{dropdown:l(()=>[e($e,null,{default:l(()=>[e(_e,{onClick:Ce},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Se))]),_:1}),o[24]||(o[24]=f(" 返回主页 ",-1))]),_:1}),e(_e,{divided:"",onClick:ye},{default:l(()=>[e(b,null,{default:l(()=>[e(p(ol))]),_:1}),o[25]||(o[25]=f(" 退出登录 ",-1))]),_:1})]),_:1})]),default:l(()=>[e(Q,{type:"text",size:"large"},{default:l(()=>[e(b,{size:"20"},{default:l(()=>[e(p(Fe))]),_:1})]),_:1})]),_:1})])])]),_:1}),e(Ue,{class:"admin-main"},{default:l(()=>[k.value==="overview"?(r(),_("div",tt,[e(Le,{gutter:20},{default:l(()=>[e(fe,{xs:12,sm:12,md:6,lg:6,xl:6},{default:l(()=>[e(de,{class:"stats-card"},{default:l(()=>[s("div",st,[s("div",ot,h(F.value),1),o[26]||(o[26]=s("div",{class:"stats-label"},"总用户数",-1))])]),_:1})]),_:1}),e(fe,{xs:12,sm:12,md:6,lg:6,xl:6},{default:l(()=>[e(de,{class:"stats-card"},{default:l(()=>[s("div",nt,[s("div",dt,h(q.value),1),o[27]||(o[27]=s("div",{class:"stats-label"},"管理员数",-1))])]),_:1})]),_:1}),e(fe,{xs:12,sm:12,md:6,lg:6,xl:6},{default:l(()=>[e(de,{class:"stats-card"},{default:l(()=>[s("div",it,[s("div",rt,h(te.value),1),o[28]||(o[28]=s("div",{class:"stats-label"},"对话总数",-1))])]),_:1})]),_:1}),e(fe,{xs:12,sm:12,md:6,lg:6,xl:6},{default:l(()=>[e(de,{class:"stats-card"},{default:l(()=>[...o[29]||(o[29]=[s("div",{class:"stats-item"},[s("div",{class:"stats-number"},"Online"),s("div",{class:"stats-label"},"系统状态")],-1)])]),_:1})]),_:1})]),_:1})])):j("",!0),k.value==="users"?(r(),_("div",ut,[e(de,null,{header:l(()=>[s("div",ct,[o[31]||(o[31]=s("span",null,"用户管理",-1)),e(Q,{type:"primary",onClick:T},{default:l(()=>[e(b,null,{default:l(()=>[e(p(_l))]),_:1}),o[30]||(o[30]=f(" 刷新 ",-1))]),_:1})])]),default:l(()=>[s("div",mt,[nl((r(),ae(Re,{data:C.value,style:{width:"100%"},class:"responsive-table"},{default:l(()=>[e(re,{prop:"id",label:"ID",width:"80"}),e(re,{prop:"username",label:"用户名","min-width":"120"}),e(re,{prop:"email",label:"邮箱","min-width":"180"}),e(re,{prop:"is_admin",label:"管理员",width:"100"},{default:l(i=>[e(Pe,{type:i.row.is_admin?"success":"info",size:"small"},{default:l(()=>[f(h(i.row.is_admin?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),e(re,{label:"操作","min-width":"200"},{default:l(i=>{var N,G;return[s("div",pt,[e(Q,{size:"small",onClick:oe=>A(i.row)},{default:l(()=>[...o[32]||(o[32]=[f(" 密码 ",-1)])]),_:1},8,["onClick"]),e(Q,{size:"small",type:"warning",onClick:oe=>ve(i.row),disabled:i.row.id===((N=p(O).user)==null?void 0:N.id)},{default:l(()=>[f(h(i.row.is_admin?"取消":"设置"),1)]),_:2},1032,["onClick","disabled"]),e(Q,{size:"small",type:"danger",onClick:oe=>ke(i.row),disabled:i.row.id===((G=p(O).user)==null?void 0:G.id)},{default:l(()=>[...o[33]||(o[33]=[f(" 删除 ",-1)])]),_:1},8,["onClick","disabled"])])]}),_:1})]),_:1},8,["data"])),[[u,P.value]])]),nl((r(),_("div",vt,[(r(!0),_(Z,null,ee(C.value,i=>{var N,G;return r(),_("div",{class:"mobile-user-card",key:i.id},[s("div",_t,[s("div",ft,[s("span",gt,h(i.username),1),e(Pe,{type:i.is_admin?"success":"info",size:"small"},{default:l(()=>[f(h(i.is_admin?"管理员":"普通用户"),1)]),_:2},1032,["type"])]),s("div",yt,[s("div",bt,[o[34]||(o[34]=s("span",{class:"detail-label"},"ID:",-1)),s("span",wt,h(i.id),1)]),s("div",ht,[o[35]||(o[35]=s("span",{class:"detail-label"},"邮箱:",-1)),s("span",kt,h(i.email||"未设置"),1)])])]),s("div",Ct,[e(Q,{size:"small",onClick:oe=>A(i),class:"mobile-action-btn"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(je))]),_:1})]),_:1},8,["onClick"]),e(Q,{size:"small",type:"warning",onClick:oe=>ve(i),disabled:i.id===((N=p(O).user)==null?void 0:N.id),class:"mobile-action-btn"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Fe))]),_:1})]),_:1},8,["onClick","disabled"]),e(Q,{size:"small",type:"danger",onClick:oe=>ke(i),disabled:i.id===((G=p(O).user)==null?void 0:G.id),class:"mobile-action-btn"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(He))]),_:1})]),_:1},8,["onClick","disabled"])])])}),128))])),[[u,P.value]])]),_:1})])):j("",!0),k.value==="providers"?(r(),_("div",Vt,[e(Da)])):j("",!0),k.value==="playground"?(r(),_("div",$t,[e(Wa)])):j("",!0),k.value==="oauth"?(r(),_("div",xt,[e(de,null,{header:l(()=>[s("div",Pt,[o[37]||(o[37]=s("span",null,"Linux.Do OAuth 配置",-1)),e(Q,{type:"primary",onClick:D,loading:B.value},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Ql))]),_:1}),o[36]||(o[36]=f(" 保存配置 ",-1))]),_:1},8,["loading"])])]),default:l(()=>[e(ge,{model:n,"label-width":"150px",class:"oauth-form"},{default:l(()=>[e(H,{label:"启用状态"},{default:l(()=>[e(Me,{modelValue:n.enabled,"onUpdate:modelValue":o[0]||(o[0]=i=>n.enabled=i)},null,8,["modelValue"]),s("span",Mt,h(n.enabled?"已启用":"已禁用"),1)]),_:1}),e(Ae),e(H,{label:"Client ID",required:""},{default:l(()=>[e(Y,{modelValue:n.client_id,"onUpdate:modelValue":o[1]||(o[1]=i=>n.client_id=i),placeholder:"请输入 Linux.Do OAuth Client ID"},null,8,["modelValue"])]),_:1}),e(H,{label:"Client Secret",required:""},{default:l(()=>[e(Y,{modelValue:n.client_secret,"onUpdate:modelValue":o[2]||(o[2]=i=>n.client_secret=i),placeholder:"请输入 Linux.Do OAuth Client Secret"},null,8,["modelValue"])]),_:1}),e(H,{label:"Redirect URL"},{default:l(()=>[e(Y,{modelValue:n.redirect_url,"onUpdate:modelValue":o[3]||(o[3]=i=>n.redirect_url=i),placeholder:"http://localhost:3000/auth/callback/linux-do"},null,8,["modelValue"]),o[38]||(o[38]=s("div",{style:{color:"#909399","font-size":"12px","margin-top":"5px"}}," 需要在 Linux.Do OAuth 应用中配置此回调地址 ",-1))]),_:1}),e(Ae,null,{default:l(()=>[...o[39]||(o[39]=[f("高级配置",-1)])]),_:1}),e(H,{label:"Authorization URL"},{default:l(()=>[e(Y,{modelValue:n.auth_url,"onUpdate:modelValue":o[4]||(o[4]=i=>n.auth_url=i),placeholder:"https://connect.linux.do/oauth2/authorize"},null,8,["modelValue"])]),_:1}),e(H,{label:"Token URL"},{default:l(()=>[e(Y,{modelValue:n.token_url,"onUpdate:modelValue":o[5]||(o[5]=i=>n.token_url=i),placeholder:"https://connect.linux.do/oauth2/token"},null,8,["modelValue"])]),_:1}),e(H,{label:"User Info URL"},{default:l(()=>[e(Y,{modelValue:n.user_info_url,"onUpdate:modelValue":o[6]||(o[6]=i=>n.user_info_url=i),placeholder:"https://connect.linux.do/api/user"},null,8,["modelValue"])]),_:1}),e(Ge,{title:"配置说明",type:"info",closable:!1,style:{"margin-top":"20px"}},{default:l(()=>[...o[40]||(o[40]=[s("p",null,"1. 前往 Linux.Do 开发者中心创建 OAuth 应用",-1),s("p",null,"2. 获取 Client ID 和 Client Secret",-1),s("p",null,"3. 配置回调地址为上方的 Redirect URL",-1),s("p",null,"4. 启用 OAuth 功能后，用户即可使用 Linux.Do 账号登录",-1)])]),_:1})]),_:1},8,["model"])]),_:1})])):j("",!0),k.value==="system"?(r(),_("div",At,[e(de,null,{header:l(()=>[...o[41]||(o[41]=[s("span",null,"系统设置",-1)])]),default:l(()=>[e(ge,{"label-width":"120px",class:"system-form"},{default:l(()=>[e(H,{label:"系统名称"},{default:l(()=>[e(Y,{modelValue:L.siteName,"onUpdate:modelValue":o[7]||(o[7]=i=>L.siteName=i),placeholder:"AI Chat System"},null,8,["modelValue"])]),_:1}),e(H,{label:"系统描述"},{default:l(()=>[e(Y,{type:"textarea",modelValue:L.siteDescription,"onUpdate:modelValue":o[8]||(o[8]=i=>L.siteDescription=i),placeholder:"一个基于AI的智能对话系统",rows:3},null,8,["modelValue"])]),_:1}),e(H,{label:"允许注册"},{default:l(()=>[e(Me,{modelValue:L.allowRegister,"onUpdate:modelValue":o[9]||(o[9]=i=>L.allowRegister=i)},null,8,["modelValue"])]),_:1}),e(H,{class:"form-actions"},{default:l(()=>[e(Q,{type:"primary",onClick:ze,class:"save-btn"},{default:l(()=>[...o[42]||(o[42]=[f("保存设置",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])):j("",!0)]),_:1})]),_:1})]),_:1}),e(t,{modelValue:S.value,"onUpdate:modelValue":o[10]||(o[10]=i=>S.value=i),direction:"ltr",size:"280px","with-header":!1,class:"mobile-menu-drawer"},{default:l(()=>[s("div",Ut,[e(be,{"default-active":k.value,class:"mobile-admin-menu","background-color":"#001529","text-color":"#ffffff","active-text-color":"#1890ff",onSelect:w},{default:l(()=>[e(X,{index:"overview"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(al))]),_:1}),o[43]||(o[43]=s("span",null,"概览",-1))]),_:1}),e(X,{index:"users"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(tl))]),_:1}),o[44]||(o[44]=s("span",null,"用户管理",-1))]),_:1}),e(X,{index:"providers"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(sl))]),_:1}),o[45]||(o[45]=s("span",null,"提供商管理",-1))]),_:1}),e(X,{index:"playground"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(Se))]),_:1}),o[46]||(o[46]=s("span",null,"操练场",-1))]),_:1}),e(X,{index:"oauth"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(je))]),_:1}),o[47]||(o[47]=s("span",null,"OAuth配置",-1))]),_:1}),e(X,{index:"system"},{default:l(()=>[e(b,null,{default:l(()=>[e(p(qe))]),_:1}),o[48]||(o[48]=s("span",null,"系统设置",-1))]),_:1})]),_:1},8,["default-active"])])]),_:1},8,["modelValue"]),e(a,{modelValue:z.value,"onUpdate:modelValue":o[14]||(o[14]=i=>z.value=i),title:"修改用户密码",width:"400px"},{footer:l(()=>[s("div",It,[e(Q,{onClick:o[13]||(o[13]=i=>z.value=!1)},{default:l(()=>[...o[49]||(o[49]=[f("取消",-1)])]),_:1}),e(Q,{type:"primary",onClick:pe,loading:U.value},{default:l(()=>[...o[50]||(o[50]=[f(" 确认 ",-1)])]),_:1},8,["loading"])])]),default:l(()=>[e(ge,{model:y,rules:R,ref_key:"passwordFormRef",ref:I},{default:l(()=>[e(H,{label:"用户名"},{default:l(()=>{var i;return[e(Y,{value:(i=M.value)==null?void 0:i.username,disabled:""},null,8,["value"])]}),_:1}),e(H,{label:"新密码",prop:"newPassword"},{default:l(()=>[e(Y,{modelValue:y.newPassword,"onUpdate:modelValue":o[11]||(o[11]=i=>y.newPassword=i),type:"password",placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),e(H,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[e(Y,{modelValue:y.confirmPassword,"onUpdate:modelValue":o[12]||(o[12]=i=>y.confirmPassword=i),type:"password",placeholder:"请确认新密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),Lt=Ye(St,[["__scopeId","data-v-1936b840"]]);export{Lt as default};
