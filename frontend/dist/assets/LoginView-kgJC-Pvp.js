/* empty css                 */import{d as q,u as N,r as c,a as _,c as S,b as a,w as s,E as U,e as F,o as f,f as I,g as v,h as V,i as L,j as R,k as A,l as h,t as g,m as b,n as y}from"./index-CUW0q8gF.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"login-container"},D={class:"card-header"},T=q({__name:"LoginView",setup(z){const i=F(),m=N(),l=c(!0),p=c(!1),d=c(),e=_({username:"",email:"",password:"",confirmPassword:""}),E=_({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(o,r,t)=>{r!==e.password?t(new Error("两次输入密码不一致")):t()},trigger:"blur"}]}),k=()=>{l.value=!l.value,x()},x=()=>{var o;e.username="",e.email="",e.password="",e.confirmPassword="",(o=d.value)==null||o.clearValidate()},C=async()=>{if(d.value)try{if(!await d.value.validate())return;p.value=!0,l.value?(await m.login({username:e.username,password:e.password}),y.success("登录成功"),m.isAdmin()?i.push("/admin"):i.push("/chat")):(await m.register({username:e.username,email:e.email,password:e.password}),y.success("注册成功"),i.push("/chat"))}catch(o){console.error("提交失败:",o)}finally{p.value=!1}};return(o,r)=>{const t=R,u=L,w=A,P=I,B=U;return f(),S("div",j,[a(B,{class:"login-card"},{header:s(()=>[b("div",D,[b("h1",null,g(l.value?"登录":"注册"),1)])]),default:s(()=>[a(P,{model:e,rules:E,ref_key:"formRef",ref:d,"label-width":"80px"},{default:s(()=>[a(u,{label:"用户名",prop:"username"},{default:s(()=>[a(t,{modelValue:e.username,"onUpdate:modelValue":r[0]||(r[0]=n=>e.username=n),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l.value?V("",!0):(f(),v(u,{key:0,label:"邮箱",prop:"email"},{default:s(()=>[a(t,{modelValue:e.email,"onUpdate:modelValue":r[1]||(r[1]=n=>e.email=n),placeholder:"请输入邮箱",type:"email"},null,8,["modelValue"])]),_:1})),a(u,{label:"密码",prop:"password"},{default:s(()=>[a(t,{modelValue:e.password,"onUpdate:modelValue":r[2]||(r[2]=n=>e.password=n),type:"password",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]),_:1}),l.value?V("",!0):(f(),v(u,{key:1,label:"确认密码",prop:"confirmPassword"},{default:s(()=>[a(t,{modelValue:e.confirmPassword,"onUpdate:modelValue":r[3]||(r[3]=n=>e.confirmPassword=n),type:"password",placeholder:"请确认密码","show-password":""},null,8,["modelValue"])]),_:1})),a(u,null,{default:s(()=>[a(w,{type:"primary",onClick:C,loading:p.value,style:{width:"100%"}},{default:s(()=>[h(g(l.value?"登录":"注册"),1)]),_:1},8,["loading"])]),_:1}),a(u,null,{default:s(()=>[a(w,{type:"text",onClick:k,style:{width:"100%"}},{default:s(()=>[h(g(l.value?"没有账号？去注册":"已有账号？去登录"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})])}}}),O=M(T,[["__scopeId","data-v-d93901b5"]]);export{O as default};
